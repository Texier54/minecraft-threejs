var Y0=Object.defineProperty;var D0=(G,O,k)=>O in G?Y0(G,O,{enumerable:!0,configurable:!0,writable:!0,value:k}):G[O]=k;var r0=(G,O,k)=>D0(G,typeof O!="symbol"?O+"":O,k);(function(){"use strict";class G{constructor(s=Math){this.grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],this.grad4=[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]],this.p=[];for(let t=0;t<256;t++)this.p[t]=Math.floor(s.random()*256);this.perm=[];for(let t=0;t<512;t++)this.perm[t]=this.p[t&255];this.simplex=[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]]}dot(s,t,o){return s[0]*t+s[1]*o}dot3(s,t,o,c){return s[0]*t+s[1]*o+s[2]*c}dot4(s,t,o,c,l){return s[0]*t+s[1]*o+s[2]*c+s[3]*l}noise(s,t){let o,c,l;const i=.5*(Math.sqrt(3)-1),n=(s+t)*i,r=Math.floor(s+n),e=Math.floor(t+n),f=(3-Math.sqrt(3))/6,j=(r+e)*f,u=r-j,a=e-j,w=s-u,R=t-a;let B,F;w>R?(B=1,F=0):(B=0,F=1);const M=w-B+f,x=R-F+f,y=w-1+2*f,_=R-1+2*f,v=r&255,b=e&255,T=this.perm[v+this.perm[b]]%12,d=this.perm[v+B+this.perm[b+F]]%12,m=this.perm[v+1+this.perm[b+1]]%12;let g=.5-w*w-R*R;g<0?o=0:(g*=g,o=g*g*this.dot(this.grad3[T],w,R));let p=.5-M*M-x*x;p<0?c=0:(p*=p,c=p*p*this.dot(this.grad3[d],M,x));let q=.5-y*y-_*_;return q<0?l=0:(q*=q,l=q*q*this.dot(this.grad3[m],y,_)),70*(o+c+l)}noise3d(s,t,o){let c,l,i,n;const e=(s+t+o)*.3333333333333333,f=Math.floor(s+e),j=Math.floor(t+e),u=Math.floor(o+e),a=1/6,w=(f+j+u)*a,R=f-w,B=j-w,F=u-w,M=s-R,x=t-B,y=o-F;let _,v,b,T,d,m;M>=x?x>=y?(_=1,v=0,b=0,T=1,d=1,m=0):M>=y?(_=1,v=0,b=0,T=1,d=0,m=1):(_=0,v=0,b=1,T=1,d=0,m=1):x<y?(_=0,v=0,b=1,T=0,d=1,m=1):M<y?(_=0,v=1,b=0,T=0,d=1,m=1):(_=0,v=1,b=0,T=1,d=1,m=0);const g=M-_+a,p=x-v+a,q=y-b+a,X=M-T+2*a,A=x-d+2*a,J=y-m+2*a,K=M-1+3*a,L=x-1+3*a,z=y-1+3*a,Y=f&255,D=j&255,E=u&255,o0=this.perm[Y+this.perm[D+this.perm[E]]]%12,i0=this.perm[Y+_+this.perm[D+v+this.perm[E+b]]]%12,c0=this.perm[Y+T+this.perm[D+d+this.perm[E+m]]]%12,l0=this.perm[Y+1+this.perm[D+1+this.perm[E+1]]]%12;let H=.6-M*M-x*x-y*y;H<0?c=0:(H*=H,c=H*H*this.dot3(this.grad3[o0],M,x,y));let N=.6-g*g-p*p-q*q;N<0?l=0:(N*=N,l=N*N*this.dot3(this.grad3[i0],g,p,q));let C=.6-X*X-A*A-J*J;C<0?i=0:(C*=C,i=C*C*this.dot3(this.grad3[c0],X,A,J));let I=.6-K*K-L*L-z*z;return I<0?n=0:(I*=I,n=I*I*this.dot3(this.grad3[l0],K,L,z)),32*(c+l+i+n)}noise4d(s,t,o,c){const l=this.grad4,i=this.simplex,n=this.perm,r=(Math.sqrt(5)-1)/4,e=(5-Math.sqrt(5))/20;let f,j,u,a,w;const R=(s+t+o+c)*r,B=Math.floor(s+R),F=Math.floor(t+R),M=Math.floor(o+R),x=Math.floor(c+R),y=(B+F+M+x)*e,_=B-y,v=F-y,b=M-y,T=x-y,d=s-_,m=t-v,g=o-b,p=c-T,q=d>m?32:0,X=d>g?16:0,A=m>g?8:0,J=d>p?4:0,K=m>p?2:0,L=g>p?1:0,z=q+X+A+J+K+L,Y=i[z][0]>=3?1:0,D=i[z][1]>=3?1:0,E=i[z][2]>=3?1:0,o0=i[z][3]>=3?1:0,i0=i[z][0]>=2?1:0,c0=i[z][1]>=2?1:0,l0=i[z][2]>=2?1:0,H=i[z][3]>=2?1:0,N=i[z][0]>=1?1:0,C=i[z][1]>=1?1:0,I=i[z][2]>=1?1:0,v0=i[z][3]>=1?1:0,a0=d-Y+e,h0=m-D+e,f0=g-E+e,d0=p-o0+e,m0=d-i0+2*e,u0=m-c0+2*e,g0=g-l0+2*e,p0=p-H+2*e,y0=d-N+3*e,M0=m-C+3*e,x0=g-I+3*e,k0=p-v0+3*e,z0=d-1+4*e,j0=m-1+4*e,w0=g-1+4*e,_0=p-1+4*e,P=B&255,Q=F&255,S=M&255,U=x&255,H0=n[P+n[Q+n[S+n[U]]]]%32,N0=n[P+Y+n[Q+D+n[S+E+n[U+o0]]]]%32,C0=n[P+i0+n[Q+c0+n[S+l0+n[U+H]]]]%32,I0=n[P+N+n[Q+C+n[S+I+n[U+v0]]]]%32,V0=n[P+1+n[Q+1+n[S+1+n[U+1]]]]%32;let Z=.6-d*d-m*m-g*g-p*p;Z<0?f=0:(Z*=Z,f=Z*Z*this.dot4(l[H0],d,m,g,p));let $=.6-a0*a0-h0*h0-f0*f0-d0*d0;$<0?j=0:($*=$,j=$*$*this.dot4(l[N0],a0,h0,f0,d0));let t0=.6-m0*m0-u0*u0-g0*g0-p0*p0;t0<0?u=0:(t0*=t0,u=t0*t0*this.dot4(l[C0],m0,u0,g0,p0));let s0=.6-y0*y0-M0*M0-x0*x0-k0*k0;s0<0?a=0:(s0*=s0,a=s0*s0*this.dot4(l[I0],y0,M0,x0,k0));let e0=.6-z0*z0-j0*j0-w0*w0-_0*_0;return e0<0?w=0:(e0*=e0,w=e0*e0*this.dot4(l[V0],z0,j0,w0,_0)),27*(f+j+u+a+w)}}class O{constructor(s){r0(this,"m_w",123456789);r0(this,"m_z",987654321);r0(this,"mask",4294967295);this.m_w=123456789+s&this.mask,this.m_z=987654321-s&this.mask}random(){this.m_z=36969*(this.m_z&65535)+(this.m_z>>16)&this.mask,this.m_w=18e3*(this.m_w&65535)+(this.m_w>>16)&this.mask;let s=(this.m_z<<16)+(this.m_w&65535)>>>0;return s/=4294967296,s}}const k={empty:{id:0,name:"empty",visible:!1},grass:{id:1,name:"grass"},dirt:{id:2,name:"dirt"},sand:{id:12,name:"sand"},gravel:{id:13,name:"gravel"},stone:{id:3,name:"stone",scale:{x:30,y:30,z:30},scarcity:.8},coalOre:{id:4,name:"coal_ore",scale:{x:20,y:20,z:20},scarcity:.8},ironOre:{id:5,name:"iron_ore",scale:{x:40,y:40,z:40},scarcity:.9},log:{id:17,name:"log"},leaves:{id:18,name:"leaves"},craftingTable:{id:58,name:"Crafting Table"}},b0=[k.coalOre,k.ironOre];let W=[];self.onmessage=function(h){const{chunkData:s,chunkSize:t,chunkHeight:o,params:c,position:l}=h.data,i=new O(c.seed);R0(t,o),T0(t,o,c,i,l),self.postMessage({data:W})};function R0(h,s,t){for(let o=0;o<h;o++){const c=[];for(let l=0;l<s;l++){const i=[];for(let n=0;n<h;n++)i.push({id:0,instanceId:null});c.push(i)}W.push(c)}}function T0(h,s,t,o,c){var i,n;const l=new G(o);for(let r=0;r<h;r++)for(let e=0;e<h;e++){const f=l.noise((c.x+r)/t.terrain.scale,(c.z+e)/t.terrain.scale),j=t.terrain.offset+t.terrain.magnitude*f;let u=Math.floor(j*s);u=Math.max(1,Math.min(u,s-1));for(let a=0;a<s;a++)a<u&&a>u-3&&((i=n0(r,a,e))==null?void 0:i.id)===k.empty.id&&V(r,a,e,k.dirt.id),a<u&&((n=n0(r,a,e))==null?void 0:n.id)===k.empty.id?(V(r,a,e,k.stone.id),G0(o,r,a,e,c)):a==u&&(O0(o,r,e,c)=="plains"?V(r,a,e,k.grass.id):V(r,a,e,k.sand.id),Math.random()<t.trees.frequency&&B0(t.seed,1,r,u+1,e,t))}}function V(h,s,t,o){W[h][s][t].id=o}function n0(h,s,t){return q0(h,s,t)&&typeof W[h]<"u"?W[h][s][t]:null}function q0(h,s,t){return h>=0&&h<16&&t>=0&&t<16&&s>=0&&s<80}function B0(h,s,t,o,c,l){const i=l.trees.trunk.minHeight,n=l.trees.trunk.maxHeight,r=Math.round(i+(n-i)*Math.random()+1);for(let e=o;e<o+r;e++)V(t,e,c,k.log.id);F0(s,t,o+r,c,l)}function F0(h,s,t,o,c){const l=c.trees.canopy.minRadius,i=c.trees.canopy.maxRadius,n=Math.round(l+(i-l)*Math.random());for(let r=-n;r<=n;r++)for(let e=-n;e<=n;e++)for(let f=-n;f<=n;f++){const j=Math.random();if(r*r+e*e+f*f>n*n)continue;const u=n0(s+r,t+e,o+f);u&&u.id!==k.empty.id||j<c.trees.canopy.density&&n0(s+r,t+e,o+f)!==null&&V(s+r,t+e,o+f,k.leaves.id)}}function G0(h,s,t,o,c){const l=new G(h);b0.forEach(i=>{l.noise((c.x+s)/i.scale.x,(c.y+t)/i.scale.y,(c.z+o)/i.scale.z)>i.scarcity&&V(s,t,o,i.id)})}function O0(h,s,t,o){const c=new G(h);let l=.01,i=c.noise((o.x+s)*l,(o.z+t)*l);return i<-.3?"desert":i<.3?"plains":"forest"}})();
