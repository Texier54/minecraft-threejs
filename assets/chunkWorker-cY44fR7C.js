var Y0=Object.defineProperty;var D0=(H,F,y)=>F in H?Y0(H,F,{enumerable:!0,configurable:!0,writable:!0,value:y}):H[F]=y;var l0=(H,F,y)=>D0(H,typeof F!="symbol"?F+"":F,y);(function(){"use strict";class H{constructor(t=Math){this.grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],this.grad4=[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]],this.p=[];for(let s=0;s<256;s++)this.p[s]=Math.floor(t.random()*256);this.perm=[];for(let s=0;s<512;s++)this.perm[s]=this.p[s&255];this.simplex=[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]]}dot(t,s,o){return t[0]*s+t[1]*o}dot3(t,s,o,i){return t[0]*s+t[1]*o+t[2]*i}dot4(t,s,o,i,r){return t[0]*s+t[1]*o+t[2]*i+t[3]*r}noise(t,s){let o,i,r;const c=.5*(Math.sqrt(3)-1),n=(t+s)*c,l=Math.floor(t+n),e=Math.floor(s+n),d=(3-Math.sqrt(3))/6,j=(l+e)*d,w=l-j,k=e-j,f=t-w,a=s-k;let O,B;f>a?(O=1,B=0):(O=0,B=1);const x=f-O+d,z=a-B+d,M=f-1+2*d,b=a-1+2*d,v=l&255,T=e&255,R=this.perm[v+this.perm[T]]%12,m=this.perm[v+O+this.perm[T+B]]%12,u=this.perm[v+1+this.perm[T+1]]%12;let g=.5-f*f-a*a;g<0?o=0:(g*=g,o=g*g*this.dot(this.grad3[R],f,a));let p=.5-x*x-z*z;p<0?i=0:(p*=p,i=p*p*this.dot(this.grad3[m],x,z));let q=.5-M*M-b*b;return q<0?r=0:(q*=q,r=q*q*this.dot(this.grad3[u],M,b)),70*(o+i+r)}noise3d(t,s,o){let i,r,c,n;const e=(t+s+o)*.3333333333333333,d=Math.floor(t+e),j=Math.floor(s+e),w=Math.floor(o+e),k=1/6,f=(d+j+w)*k,a=d-f,O=j-f,B=w-f,x=t-a,z=s-O,M=o-B;let b,v,T,R,m,u;x>=z?z>=M?(b=1,v=0,T=0,R=1,m=1,u=0):x>=M?(b=1,v=0,T=0,R=1,m=0,u=1):(b=0,v=0,T=1,R=1,m=0,u=1):z<M?(b=0,v=0,T=1,R=0,m=1,u=1):x<M?(b=0,v=1,T=0,R=0,m=1,u=1):(b=0,v=1,T=0,R=1,m=1,u=0);const g=x-b+k,p=z-v+k,q=M-T+k,X=x-R+2*k,A=z-m+2*k,J=M-u+2*k,K=x-1+3*k,L=z-1+3*k,_=M-1+3*k,Y=d&255,D=j&255,E=w&255,o0=this.perm[Y+this.perm[D+this.perm[E]]]%12,i0=this.perm[Y+b+this.perm[D+v+this.perm[E+T]]]%12,c0=this.perm[Y+R+this.perm[D+m+this.perm[E+u]]]%12,r0=this.perm[Y+1+this.perm[D+1+this.perm[E+1]]]%12;let N=.6-x*x-z*z-M*M;N<0?i=0:(N*=N,i=N*N*this.dot3(this.grad3[o0],x,z,M));let C=.6-g*g-p*p-q*q;C<0?r=0:(C*=C,r=C*C*this.dot3(this.grad3[i0],g,p,q));let I=.6-X*X-A*A-J*J;I<0?c=0:(I*=I,c=I*I*this.dot3(this.grad3[c0],X,A,J));let V=.6-K*K-L*L-_*_;return V<0?n=0:(V*=V,n=V*V*this.dot3(this.grad3[r0],K,L,_)),32*(i+r+c+n)}noise4d(t,s,o,i){const r=this.grad4,c=this.simplex,n=this.perm,l=(Math.sqrt(5)-1)/4,e=(5-Math.sqrt(5))/20;let d,j,w,k,f;const a=(t+s+o+i)*l,O=Math.floor(t+a),B=Math.floor(s+a),x=Math.floor(o+a),z=Math.floor(i+a),M=(O+B+x+z)*e,b=O-M,v=B-M,T=x-M,R=z-M,m=t-b,u=s-v,g=o-T,p=i-R,q=m>u?32:0,X=m>g?16:0,A=u>g?8:0,J=m>p?4:0,K=u>p?2:0,L=g>p?1:0,_=q+X+A+J+K+L,Y=c[_][0]>=3?1:0,D=c[_][1]>=3?1:0,E=c[_][2]>=3?1:0,o0=c[_][3]>=3?1:0,i0=c[_][0]>=2?1:0,c0=c[_][1]>=2?1:0,r0=c[_][2]>=2?1:0,N=c[_][3]>=2?1:0,C=c[_][0]>=1?1:0,I=c[_][1]>=1?1:0,V=c[_][2]>=1?1:0,b0=c[_][3]>=1?1:0,a0=m-Y+e,d0=u-D+e,h0=g-E+e,f0=p-o0+e,m0=m-i0+2*e,u0=u-c0+2*e,g0=g-r0+2*e,p0=p-N+2*e,y0=m-C+3*e,M0=u-I+3*e,k0=g-V+3*e,x0=p-b0+3*e,z0=m-1+4*e,_0=u-1+4*e,j0=g-1+4*e,w0=p-1+4*e,P=O&255,Q=B&255,S=x&255,U=z&255,H0=n[P+n[Q+n[S+n[U]]]]%32,N0=n[P+Y+n[Q+D+n[S+E+n[U+o0]]]]%32,C0=n[P+i0+n[Q+c0+n[S+r0+n[U+N]]]]%32,I0=n[P+C+n[Q+I+n[S+V+n[U+b0]]]]%32,V0=n[P+1+n[Q+1+n[S+1+n[U+1]]]]%32;let Z=.6-m*m-u*u-g*g-p*p;Z<0?d=0:(Z*=Z,d=Z*Z*this.dot4(r[H0],m,u,g,p));let $=.6-a0*a0-d0*d0-h0*h0-f0*f0;$<0?j=0:($*=$,j=$*$*this.dot4(r[N0],a0,d0,h0,f0));let t0=.6-m0*m0-u0*u0-g0*g0-p0*p0;t0<0?w=0:(t0*=t0,w=t0*t0*this.dot4(r[C0],m0,u0,g0,p0));let s0=.6-y0*y0-M0*M0-k0*k0-x0*x0;s0<0?k=0:(s0*=s0,k=s0*s0*this.dot4(r[I0],y0,M0,k0,x0));let e0=.6-z0*z0-_0*_0-j0*j0-w0*w0;return e0<0?f=0:(e0*=e0,f=e0*e0*this.dot4(r[V0],z0,_0,j0,w0)),27*(d+j+w+k+f)}}class F{constructor(t){l0(this,"m_w",123456789);l0(this,"m_z",987654321);l0(this,"mask",4294967295);this.m_w=123456789+t&this.mask,this.m_z=987654321-t&this.mask}random(){this.m_z=36969*(this.m_z&65535)+(this.m_z>>16)&this.mask,this.m_w=18e3*(this.m_w&65535)+(this.m_w>>16)&this.mask;let t=(this.m_z<<16)+(this.m_w&65535)>>>0;return t/=4294967296,t}}const y={empty:{id:0,name:"empty",visible:!1},grass:{id:1,name:"grass"},dirt:{id:2,name:"dirt"},bedrock:{id:7,name:"bedrock"},sand:{id:12,name:"sand"},gravel:{id:13,name:"gravel"},stone:{id:3,name:"stone",scale:{x:30,y:30,z:30},scarcity:.8},coalOre:{id:16,name:"coal_ore",scale:{x:20,y:20,z:20},scarcity:.8},ironOre:{id:15,name:"iron_ore",scale:{x:40,y:40,z:40},scarcity:.9},diamondOre:{id:56,name:"diamond_ore",scale:{x:40,y:40,z:40},scarcity:.99},log:{id:17,name:"log"},leaves:{id:18,name:"leaves"},craftingTable:{id:58,name:"Crafting Table"}},v0=[y.coalOre,y.ironOre,y.diamondOre];let W=[];self.onmessage=function(h){const{chunkData:t,chunkSize:s,chunkHeight:o,params:i,position:r}=h.data,c=new F(i.seed);T0(s,o),O0(s,o,i,c,r),self.postMessage({data:W})};function T0(h,t,s){for(let o=0;o<h;o++){const i=[];for(let r=0;r<t;r++){const c=[];for(let n=0;n<h;n++)c.push({id:0,instanceId:null});i.push(c)}W.push(i)}}function O0(h,t,s,o,i){var c,n;const r=new H(o);for(let l=0;l<h;l++)for(let e=0;e<h;e++){let d=G0(r,l,e,i);const j=s.biomes[d].scale,w=r.noise((i.x+l)/j,(i.z+e)/j),k=s.terrain.offset+s.terrain.magnitude*w;let f=Math.floor(k*t);f=Math.max(1,Math.min(f,t-1));for(let a=0;a<t;a++)if(a<f&&a>f-3&&((c=n0(l,a,e))==null?void 0:c.id)===y.empty.id&&G(l,a,e,y.dirt.id),a==0)G(l,a,e,y.bedrock.id);else if(a<f&&((n=n0(l,a,e))==null?void 0:n.id)===y.empty.id)G(l,a,e,y.stone.id),F0(o,l,a,e,i);else if(a==f){d=="plains"||d=="forest"?G(l,a,e,y.grass.id):G(l,a,e,y.sand.id);let O=1;d=="forest"&&(O=6),d!="desert"&&Math.random()<s.trees.frequency*O&&q0(s.seed,1,l,f+1,e,s)}}}function G(h,t,s,o){W[h][t][s].id=o}function n0(h,t,s){return R0(h,t,s)&&typeof W[h]<"u"?W[h][t][s]:null}function R0(h,t,s){return h>=0&&h<16&&s>=0&&s<16&&t>=0&&t<80}function q0(h,t,s,o,i,r){const c=r.trees.trunk.minHeight,n=r.trees.trunk.maxHeight,l=Math.round(c+(n-c)*Math.random()+1);for(let e=o;e<o+l;e++)G(s,e,i,y.log.id);B0(t,s,o+l,i,r)}function B0(h,t,s,o,i){const r=i.trees.canopy.minRadius,c=i.trees.canopy.maxRadius,n=Math.round(r+(c-r)*Math.random());for(let l=-n;l<=n;l++)for(let e=-n;e<=n;e++)for(let d=-n;d<=n;d++){const j=Math.random();if(l*l+e*e+d*d>n*n)continue;const w=n0(t+l,s+e,o+d);w&&w.id!==y.empty.id||j<i.trees.canopy.density&&n0(t+l,s+e,o+d)!==null&&G(t+l,s+e,o+d,y.leaves.id)}}function F0(h,t,s,o,i){const r=new H(h);v0.forEach(c=>{r.noise((i.x+t)/c.scale.x,(i.y+s)/c.scale.y,(i.z+o)/c.scale.z)>c.scarcity&&G(t,s,o,c.id)})}function G0(h,t,s,o){let i=h.noise((o.x+t)/1500,(o.z+s)/1500);return i+=.2*h.noise((o.x+t)/500,(o.z+s)/500),i<.25?"plains":i<.5?"forest":"desert"}})();
